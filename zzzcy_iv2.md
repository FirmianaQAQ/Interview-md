# node
- 什么是错误优先的回调？

```
错误优先的回调函数用于传递错误和数据，第一个参数始终应该是一个错误对象，用于检查程序是否发生了错误，其余的参数用于传递数据
```
- node中的异步和同步怎么理解

```
node是单线程的，异步是通过一次次的循环事件队列来实现的．同步则是说阻塞式的IO,这在高并发环境会是一个很大的性能问题，所以同步一般只在基础框架的启动时使用，用来加载配置文件，初始化程序什么的．

```

- 请介绍一下Node事件循环的流程


```
在进程启动时，Node便会创建一个类似于while(true)的循环，每执行一次循环体的过程我们成为Tick。

每个Tick的过程就是查看是否有事件待处理。如果有就取出事件及其相关的回调函数。然后进入下一个循环，如果不再有事件处理，就退出进程。
```

- 在每个tick的过程中，如何判断是否有事件需要处理呢？


```
每个事件循环中有一个或者多个观察者，而判断是否有事件需要处理的过程就是向这些观察者询问是否有要处理的事件。


在Node中，事件主要来源于网络请求、文件的I/O等，这些事件对应的观察者有文件I/O观察者，网络I/O的观察者。


事件循环是一个典型的生产者/消费者模型。异步I/O，网络请求等则是事件的生产者，源源不断为Node提供不同类型的事件，这些事件被传递到对应的观察者那里，事件循环则从观察者那里取出事件并处理。


在windows下，这个循环基于IOCP创建，在*nix下则基于多线程创建

```

- 请谈一下内存泄漏是什么，以及常见内存泄漏的原因，和排查的方法

```
内存泄漏(Memory Leak)指由于疏忽或错误造成程序未能释放已经不再使用的内存的情况。
如果内存泄漏的位置比较关键，那么随着处理的进行可能持有越来越多的无用内存，这些无用的内存变多会引起服务器响应速度变慢。
严重的情况下导致内存达到某个极限(可能是进程的上限，如 v8 的上限;也可能是系统可提供的内存上限)会使得应用程序崩溃。

```
```
常见内存泄漏的原因 内存泄漏的几种情况:
  1 全局变量
  2 闭包:闭包会引用到父级函数中的变量，如果闭包未释3 放，就会导致内存泄漏。
  3 事件监听:例如对同一个事件重复监听，忘记移除(removeListener)，将造成内存泄漏

```

```
排查方法
想要定位内存泄漏，通常会有两种情况：

对于只要正常使用就可以重现的内存泄漏，这是很简单的情况只要在测试环境模拟就可以排查了。

对于偶然的内存泄漏，一般会与特殊的输入有关系。想稳定重现这种输入是很耗时的过程。如果不能通过代码的日志定位到这个特殊的输入，那么推荐去生产环境打印内存快照了。需要注意的是，打印内存快照是很耗 CPU 的操作，可能会对线上业务造成影响。

```

